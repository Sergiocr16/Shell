<div>
    <h2><span class="glyphicon glyphicon-king"></span>&nbsp;Manejo de riesgos - {{vm.proyecto.nombre}}</h2>
    <!--<jhi-alert></jhi-alert>-->
    <!--<div class="container-fluid">-->
        <!--<div class="row">-->
            <!--<div class="col-xs-4 no-padding-left">-->
                <!--<button class="btn btn-primary" ui-sref="riesgo.new" >-->
                    <!--<span class="glyphicon glyphicon-plus"></span>-->
                    <!--<span  data-translate="shellApp.riesgo.home.createLabel">-->
                        <!--Create new Riesgo-->
                    <!--</span>-->
                <!--</button>-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12 no-padding-left">
                <button class="btn btn-primary" ng-click="vm.ocultar()">
                    <span class="glyphicon glyphicon-equalizer"></span>
                    <span ng-show="vm.mostrarTablas==false">
                       Mostrar tablas y matriz
                    </span>
                    <span ng-show="vm.mostrarTablas==true">
                       Ocultar tablas y matriz
                    </span>
                </button>
                <button class="btn btn-primary" ui-sref="manejo-riesgos.rango-riesgos({id:vm.proyecto.id})">
                    <span class="glyphicon glyphicon-sort-by-attributes"></span>
                    <span>
                       Definir rangos de riesgos
                    </span>
                </button>
                <button ng-show="vm.editando==false" class="btn btn-primary" ng-click="vm.agregarRiesgo(true)" >
                    <span class="glyphicon glyphicon-plus"></span>
                    <span>
                       Agregar riesgo
                    </span>
                </button>
            </div>

        </div>
    </div>
    <br/>

    <div class="col-lg-12" ng-show="vm.mostrarAgregarRiesgo || vm.editando">
        <form name="editForm" role="form" novalidate ng-submit="vm.saveRiesgo()">

            <div class="modal-header">
                <h4 ng-show="vm.mostrarAgregarRiesgo"class="modal-title" id="myRiesgoLabel">Agregando riesgo</h4>
                <h4 ng-show="vm.editando"class="modal-title" id="myRiesgo1Label">Editando riesgo</h4>
            </div>
            <div class="modal-body col-lg-12">
                <div class="form-group col-lg-12">
                    <div class="col-lg-6">
                    <label class="control-label"  for="field_description">Descripción</label>
                    <textarea type="text" class="form-control" name="description" id="field_description"
                           ng-model="vm.riesgo.description" required rows="5"
                    ></textarea>
                    </div>
                    <div class="col-lg-6">
                       <div class="col-lg-6">
                           <label for="impactos" style="margin-top:10px">Impacto</label>
                           <select class="form-control" id="impactos" name="tablaProbabilidad" ng-model="vm.riesgo.impacto" ng-options="impacto.valor as impacto.categoria for impacto in vm.impactos" required>
                               <option value=""></option>
                           </select>
                       </div>

                        <div class="col-lg-6">
                            <label for="probabilidades" style="margin-top:10px">Probabilidad</label>
                            <select class="form-control" id="probabilidades" name="tablaProbabilidad" ng-model="vm.riesgo.probabilidad" ng-options="probabilidad.valor as probabilidad.categoria for probabilidad in vm.probabilidades" required>
                                <option value=""></option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" ng-click="vm.agregarRiesgo(false)">
                    <span data-translate="entity.action.cancel">Cancel</span>
                </button>
                <button type="submit" ng-disabled="editForm.$invalid || vm.isSaving" class="btn btn-primary">
                    <span>Aceptar</span>
                </button>
            </div>
        </form>

    </div>
    <div class="col-lg-12" ng-show="vm.mostrarTablas==true">
        <div class="col-lg-6">
            <table class="table table-sm table-striped table-bordered" style="margin-top:10px">
                <thead>
                <tr class="bg-danger">
                    <th scope="col-3" colspan="3" class="text-center" style="background-color:#dc3545!important;color:white">Tabla de impacto</th>
                </tr>
                <tr class="bg-danger">
                    <th scope="col" class="text-center">Categoría</th>
                    <th scope="col" class="text-center">Descripción</th>
                    <th scope="col" class="text-center">Valor</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="impacto in vm.impactos| orderBy: 'valor'" style="background-color:white">
                    <td class="text-center"><b>{{impacto.categoria}}</b></td>
                    <td>{{impacto.descripcion}}</td>
                    <td>{{impacto.valor}}</td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="col-lg-6">
            <table class="table table-sm table-striped table-bordered" style="margin-top:10px">
                <thead>
                <tr class="bg-primary">
                    <th scope="col-3" colspan="4" class="text-center">Tabla de probabilidades</th>
                </tr>
                <tr class="bg-info">
                    <th scope="col" class="text-center">Categoría</th>
                    <th scope="col" class="text-center">Descripción</th>
                    <th scope="col" class="text-center">Rango</th>
                    <th scope="col" class="text-center">Valor</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="probabilidad in vm.probabilidades | orderBy: 'valor'" style="background-color:white">
                    <td class="text-center"><b>{{probabilidad.categoria}}</b></td>
                    <td>{{probabilidad.descripcion}}</td>
                    <td>{{probabilidad.rangoMenor}}% a {{probabilidad.rangoMayor}}%</td>
                    <td>{{probabilidad.valor}}</td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="col-lg-12">
            <table class="table table-sm table-striped table-bordered" style="margin-top:10px">
                <thead>
                <tr class="bg-success">
                    <th scope="col-3" colspan="{{vm.impactos.length+3}}" class="text-center" style="background-color:#28a745!important;color:white">Matriz de probabilidad e impacto</th>
                </tr>
                <tr class="bg-info">
                    <th scope="col" class="text-center"></th>
                    <th scope="col" class="text-center"></th>
                    <th ng-repeat="impacto in vm.impactos  | orderBy: 'valor'" scope="col" class="text-center">{{impacto.valor}}</th>
                    <!--<th scope="col" class="text-center">Descripción</th>-->
                    <!--<th scope="col" class="text-center">Rango</th>-->
                    <!--<th scope="col" class="text-center">Valor</th>-->
                </tr>
                <tr class="bg-info">
                    <th scope="col" class="text-center"></th>
                    <th scope="col" class="text-center"></th>
                    <th ng-repeat="impacto in vm.impactos" scope="col" class="text-center">{{impacto.categoria}}</th>
                    <!--<th scope="col" class="text-center">Descripción</th>-->
                    <!--<th scope="col" class="text-center">Rango</th>-->
                    <!--<th scope="col" class="text-center">Valor</th>-->
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="probabilidad in vm.probabilidades  | orderBy: 'valor'" style="background-color:white">
                    <td class="text-center bg-success"><b>{{probabilidad.valor}}</b></td>
                    <td class="text-center bg-success"><b>{{probabilidad.categoria}}</b></td>
                    <td ng-repeat="impacto in vm.impactos  | orderBy: 'valor'" class="text-center">{{impacto.valor*probabilidad.valor}}</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <h3>Riesgos del proyecto</h3>

    <h5 class="text-center" ng-show="vm.riesgos.length==0">No hay riesgos aún</h5>
    <div class="table-responsive"  ng-show="vm.riesgos.length>0 ">
        <table class="jh-table table table-striped">
            <thead>
                <tr jh-sort="vm.predicate" ascending="vm.reverse" callback="vm.transition()">
                    <!--<th jh-sort-by="id"><span data-translate="global.field.id">ID</span> <span class="glyphicon glyphicon-sort"></span></th>-->
                    <th jh-sort-by="description">Descripción</span></th>
                    <th jh-sort-by="probabilidad"><span >Probabilidad</span></th>
                    <th jh-sort-by="impacto"><span >Impacto</span></th>
                    <!--<th jh-sort-by="proyectoId"><span data-translate="shellApp.riesgo.proyecto">Proyecto</span> <span class="glyphicon glyphicon-sort"></span></th>-->
                    <!--<th jh-sort-by="medidaId"><span data-translate="shellApp.riesgo.medida">Medida</span> <span class="glyphicon glyphicon-sort"></span></th>-->
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="riesgo in vm.riesgos track by riesgo.id">
                    <!--<td><a ui-sref="riesgo-detail({id:riesgo.id})">{{riesgo.id}}</a></td>-->
                    <td>{{riesgo.description}}</td>
                    <td>{{vm.verProbabilidad(riesgo.probabilidad)}}</td>
                    <td>{{vm.verImpacto(riesgo.impacto)}}</td>
                    <!--<td>-->
                        <!--<a ui-sref="proyecto-detail({id:riesgo.proyectoId})">{{riesgo.proyectoId}}</a>-->
                    <!--</td>-->
                    <!--<td>-->
                        <!--<a ui-sref="medida-detail({id:riesgo.medidaId})">{{riesgo.medidaId}}</a>-->
                    <!--</td>-->
                    <td class="text-right">
                        <div class="btn-group flex-btn-group-container">
                            <!--<button type="submit"-->
                                    <!--ui-sref="riesgo-detail({id:riesgo.id})"-->
                                    <!--class="btn btn-info btn-sm">-->
                                <!--<span class="glyphicon glyphicon-eye-open"></span>-->
                                <!--<span class="hidden-sm-down" data-translate="entity.action.view"></span>-->
                            <!--</button>-->
                            <button type="submit"
                                    ng-click="vm.editar(riesgo)"
                                    class="btn btn-primary btn-sm">
                                <span class="glyphicon glyphicon-pencil"></span>
                                <span class="hidden-sm-down" data-translate="entity.action.edit"></span>
                            </button>
                            <button type="submit"
                                    ng-click="vm.eliminar(riesgo)"
                                    class="btn btn-danger btn-sm">
                                <span class="glyphicon glyphicon-remove-circle"></span>
                                <span class="hidden-sm-down"></span>
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="col-lg-12 no-padding-left">
            <h1 class="text-center">
            <button ng-disabled="vm.isCalcular()"class="btn btn-primary" ui-sref="manejo-riesgos.calculo-valor-riesgos({id:vm.proyecto.id})">
                <span class="glyphicon glyphicon-eye"></span>
                <span>
                      Cálculo del valor de los riesgos
                </span>
            </button>
            <h6 ng-show="vm.isCalcular()" class="text-center" style="color:red">
                  *Para realizar el cálculo debes de asignar el valor de los rangos de riesgos del proyecto
            </h6>
            </h1>
        </div>
    </div>

    <!--<div class="text-center">-->
        <!--<jhi-item-count page="vm.page" total="vm.queryCount" items-per-page="vm.itemsPerPage"></jhi-item-count>-->
    <!--</div>-->
    <!--<uib-pager total-items="vm.totalItems" ng-model="vm.page" ng-change="vm.transition()"></uib-pager>-->
    <button type="submit"
            ui-sref="proyecto-detail({id:vm.proyecto.id})"
            class="btn btn-info">
        <span class="glyphicon glyphicon-arrow-left"></span>&nbsp;<span data-translate="entity.action.back"> Back</span>
    </button>

    <!--<button type="button" ui-sref="proyecto-detail({id:vm.proyecto.id})" class="btn btn-primary">-->
        <!--<span class="glyphicon glyphicon-pencil"></span>-->
        <!--<span class="hidden-sm-down" data-translate="entity.action.edit"> Edit</span>-->
    <!--</button>-->
</div>
